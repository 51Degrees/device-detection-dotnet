<!-- HTML header for doxygen 1.8.15-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>51Degrees Device Detection .NET: 51Degrees Common Code Library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="examplegrabber.js"></script>
<script type="text/javascript" src="testedversionsgrabber.js"></script>
<script type="text/javascript" src="search51.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="docs-main.min.css" rel="stylesheet" type="text/css" />
</head>
<body class="l-docs-index p-doxygen">
<div class="l-index__content">
<!--div id="top"--><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea" class="g-header g-header--docs">
  <h1 class="c-brand">
  <a id="projectlogo" href="../../documentation/4.4/index.html" class="c-brand__link"><img class="c-brand__image" alt="Logo" src="logo-51Degrees-Docs.png" style="width:172px;"/></a>
  <span class="c-tagline">51Degrees Device Detection .NET
   &#160;<span id="projectnumber">4.4</span>
  </span>
  </h1>
  <div id="projectalign" style="padding-left: 0.5em;">
   <div id="projectbrief">Device detection services for 51Degrees Pipeline</div>
  </div>
  <div id="main-nav"></div>
  <section class="g-search">
    <div class="c-search is-openable" id="searchOpenable">
    <form class="c-search__form">
      <div class="b-form-group b-form-group--with-icon">
        <label for="inputSearch" class="b-text--hidden">Search</label>
        <img src="icon-search.svg" class="b-icon" alt="Search" />
        <input type="text" class="c-search__input" id="inputSearch" onkeyup="javascript:onSearch(this,event.keyCode)" placeholder="Search" aria-label="Search">
      </div>
    </form>
    <div class="c-search__content" id="searchContent">
    </div>
  </div> 
  </section>
</div>
<!-- end header part -->
<main class="g-main">
<!-- Generated by Doxygen 1.8.15 -->
<!-- top -->
	<div class="g-docs__sidenav">																														         <nav id="nav-tree-contents" class="c-sidenav">																														     <h4 class="c-sidenav__heading">Documentation</h4>																									         <div id="nav-sync" class="sync"></div>
  <ul class="c-sidenav__list">																														     </ul>																																				   </nav>    </div><script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md__home_runner_work_device-detection-dotnet_device-detection-dotnet_common_device-detection-dot97b3d82d7f2a67358273563edf1971a7.html','');});
/* @license-end */
</script>
<div id="doc-content" class="g-docs__content">
<div class="PageDoc"><div class="g-docs__header">
<div class="c-breadcrumb">
  <ul class="c-breadcrumb">
<li class="c-breadcrumb__item"><a class="c-breadcrumb__link" href="md__home_runner_work_device-detection-dotnet_device-detection-dotnet_common_device-detection-dot97b3d82d7f2a67358273563edf1971a7.html">51Degrees Common Code Library</a></li>  </ul>
</div>
<h2 class="g-docs__page-title">51Degrees Common Code Library </h2></div><!--header-->
<div class="g-docs__inner">
<div class="g-docs__primary" id="primary">
<section class="g-docs__section"><img src="https://51degrees.com/DesktopModules/FiftyOne/Distributor/Logo.ashx?utm_source=github&utm_medium=repository&utm_content=home&utm_campaign=c-open-source" alt="51Degrees" title="Data rewards the curious" class="inline"/>
 <b>51Degrees Common C Code</b></p>
<p><a href="https://51degrees.com/device-detection-cxx/4.4/index.html" title="Reference documentation">Reference Documentation</a></p>
<h1 class="g-docs__section-heading">Introduction</h1>
<p>The 51Degrees Common Code Library groups common methods and structures used in 51Degrees APIs. This includes methods to stream from files, data sets, collections of items, arrays, memory management among other things. Anything which is not specific to a functional API is contained here as generic implementations which can be reused in multiple specific use cases.</p>
<h1 class="g-docs__section-heading">Naming Conventions</h1>
<p>All public methods and structures are prefixed by <code>fiftyoneDegrees</code> then the name of the area they belong to, e.g. the <code>fiftyoneDegreesCollection</code> prefix indicates it exists in <code>collection.c/h</code>.</p>
<p>The next part of a method name is the verb which describes what the method does, common terms are:</p>
<div class="g-table g-table--overflow"><table class="c-table">
<tr class="c-table__row--heading">
<td class="c-table__cell">Verb  </td><td class="c-table__cell">Meaning   </td></tr>
<tr class="c-table__row">
<td class="c-table__cell">Init  </td><td class="c-table__cell">Initializes a structure which has already been allocated. This will take a pointer to the structure which is to initialized.   </td></tr>
<tr class="c-table__row">
<td class="c-table__cell">Create  </td><td class="c-table__cell">Allocates and initializes a new structure, then returns the pointer.   </td></tr>
<tr class="c-table__row">
<td class="c-table__cell">Size  </td><td class="c-table__cell">Returns the number of bytes which will be allocated by the accompanying <code>create</code> or <code>init</code> method. Implicitly, <code>create</code> or <code>init</code> methods which have no accompanying <code>size</code> method do not allocate any memory.   </td></tr>
<tr class="c-table__row">
<td class="c-table__cell">Get  </td><td class="c-table__cell">Returns a value or pointer which may need to be released after use.   </td></tr>
<tr class="c-table__row">
<td class="c-table__cell">Add  </td><td class="c-table__cell">Add an item to a structure, this may or may not allocate memory.   </td></tr>
<tr class="c-table__row">
<td class="c-table__cell">Process  </td><td class="c-table__cell">Processes data and populates a structure which is passed in.   </td></tr>
<tr class="c-table__row">
<td class="c-table__cell">Free  </td><td class="c-table__cell">Frees the memory allocated to a structure.   </td></tr>
<tr class="c-table__row">
<td class="c-table__cell">Release  </td><td class="c-table__cell">Releases a resource back to the resource manager or whatever structure in charge of handing out references to that particular resource.   </td></tr>
</table>
</div><p>e.g. the <code>fiftyoneDegreesDataSetGet</code> returns a pointer to a data set which will need to be released with the <code>fiftyoneDegreesDataSetRelease</code> method.</p>
<p>Finally, the optional last part completes the description of the method's use, e.g. <code>fiftyoneDegreesDataSetInitFromMemory</code> or <code>fiftyoneDegreesDataSetInitFromFile</code>.</p>
<h1 class="g-docs__section-heading">Installing</h1>
<h2>Dependencies</h2>
<p>When compiling on Linux, there is a dependency on <code>libatomic</code>. This is usually already present as part of the C libraries, and is included as part of GCC 5 and above. On other systems, can be installed with:</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line">sudo apt-get install libatomic1</div></div><h2>Using CMake</h2>
<p>To build the make files required to build, open a <code>bash</code> or <code>Visual Studio Developer Command Prompt</code> terminal and run</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line">mkdir build</div><div class="c-code__line">cd build</div><div class="c-code__line">cmake .. </div></div><p>Note: on an x64 Windows system, it is necessary to add <code>-A x64</code> as CMake will build a Win32 Solution by default.</p>
<p>Then build the whole solution with</p>
<div class="c-code__block c-code__block--outline"><div class="c-code__line">cmake --build . --config Release</div></div><p>Libraries are output to the <code>lib/</code> directory, and executables like examples and tests are output to the <code>bin/</code> directory.</p>
<h2>Using Visual Studio</h2>
<p>Calling <code>CMake</code> in an MSVC environment (as described in the <a href="#Using-CMake">Using CMake</a> section) will produce a Visual Studio solution with projects for all libraries, examples, and tests. However, it is preferable to use the dedicated Visual Studio solution in the <code>VisualStudio/</code> directory.</p>
<p>Prerequisites:</p><ul>
<li>Required Visual Studio 2019 or equivalent <a href="https://visualstudio.microsoft.com/visual-cpp-build-tools/">C++ build tool</a><ul>
<li>Minimum Platform Toolset Version <code>v142</code></li>
<li>Minimum Windows SDK Version <code>10.0.18362.0</code></li>
</ul>
</li>
</ul>
<h2>Build Options</h2>
<h3>MemoryOnly</h3>
<p>In memory only operation compiling without stream capabilities using the <code>FIFTYONE_DEGREES_MEMORY_ONLY</code> directive results in performance improvements. By removing the unnecessary jumps to methods which are only used in stream operation, the performance of in memory collections is improved.</p>
<p>The option is enabled using the <code>FIFTYONE_DEGREES_MEMORY_ONLY</code> compile flag, which can also be set through CMake using the <code>-DMemoryOnly=YES</code> option, or through Visual Studio using the the <code>Debug-MemoryOnly</code> or <code>Release-MemoryOnly</code> build configurations.</p>
<h3>NoThreading</h3>
<p>In single threaded operation compiling without threading using the <code>FIFTYONE_DEGREES_NO_THREADING</code> directive results in performance improvements. By removing logic needed to keep operations thread safe, the performance of many operations are improved.</p>
<p>The option is enabled using the <code>FIFTYONE_DEGREES_NO_THREADING</code> compile flag, which can also be set through CMake using the <code>-DNoThreading=YES</code> option, or through Visual Studio using the <code>Debug-Single</code> or <code>Release-Single</code> build configurations.</p>
<p>WARNING: This option should only be enabled in single threaded environments, as it means operations will not be thread safe.</p>
<h3>ExceptionsDisabled</h3>
<p>Exceptions are handled in the common library using the <code>fiftyoneDegreesException</code> structure. This logic can be disabled using the <code>FIFTYONE_DEGREES_EXCEPTIONS_DISABLED</code> directive, resulting in performance improvements.</p>
<p>The options is enabled using the <code>FIFTYONE_DEGREES_EXCEPTIONS_DISABLED</code> compile flag, which can also be set through CMake using the <code>-DExceptionsDisabled=YES</code> option.</p>
<p>WARNING: When exception handling is disabled, using the functionality in this library incorrectly can result in a segmentation fault instead of an exception being set.</p>
<h1 class="g-docs__section-heading">Tests</h1>
<p>All unit, integration, and performance tests are built using the <a href="https://github.com/google/googletest">Google test framework</a>.</p>
<h2>CMake</h2>
<p>CMake automatically pulls in the latest Google Test from GitHub.</p>
<p>Building the project builds the test executable <code>CommonTests</code> to the <code>bin/</code> directory. This can be run directly from a terminal.</p>
<p>These can be run by calling </p><div class="c-code__block c-code__block--outline"><div class="c-code__line">ctest</div></div><p>CTest module automatically creates a <code>BUILD_TESTING</code> option &ndash; see <a href="https://cmake.org/cmake/help/latest/module/CTest.html">https://cmake.org/cmake/help/latest/module/CTest.html</a></p>
<p>When testing some dependent code, running <code>CommonTests</code> can be skipped by turning OFF the <code>FIFTYONE_COMMON_CXX_BUILD_TESTING</code> option.</p>
<p>If CMake has been used in an MSVC environment, then the tests will be set up and discoverable in the Visual Studio solution <code>51DegreesCommon</code> created by CMake.</p>
<h2>Visual Studio</h2>
<p>Tests in the Visual Studio solution automatically install the GTest dependency via a NuGet package. However, in order for the tests to show up in the Visual Studio test explorer, the <a href="https://marketplace.visualstudio.com/items?itemName=VisualCPPTeam.TestAdapterforGoogleTest">Test Adapter for Google Test</a> extension must be installed.</p>
<p>The VisualStudio solution includes <code>FiftyOne.Common.Tests</code>, which can be run through the standard Visual Studio test runner.</p>
<h1 class="g-docs__section-heading">Referencing the library</h1>
<h2>CMake</h2>
<p>When building using CMake, static libraries are built in stages. These can be included in an executable just as they are in the examples. If these are included through a CMake file, the dependencies will be resolved automatically. However, if linking another way, all dependencies will need to be included from the <code>lib/</code> directory. For example, to use the Common C library, the <code>fiftyone-common-c</code> static library would need to be included, and for C++, <code>fiftyone-common-cxx</code> is needed in addition.</p>
<h2>Visual Studio</h2>
<p>The Visual Studio solution contains static libraries which have all the dependencies set up correctly, so referencing these in a Visual Studio solution should be fairly self explanatory.</p>
<h2>Code Coverage</h2>
<p>When the project files are generated for a non-MSVC compiler (gcc/clang) with <code>CMAKE_BUILD_TYPE=Debug</code> f.e. by running: </p><div class="c-code__block c-code__block--outline"><div class="c-code__line">cmake . -DCMAKE_BUILD_TYPE=Debug</div></div><p>the generated targets will contain code coverage instrumentation instructions to be added to the libraries with <code>-cov</code> suffix and <code>CommonTests</code> target will be linked with them. During build time <code>*.gcno</code> and empty <code>*.gcda</code> files are generated.</p>
<p>During the test run <code>*.gcda</code> files will be filled with coverage data.</p>
<p>Install gcovr tool by running: </p><div class="c-code__block c-code__block--outline"><div class="c-code__line">pip3 install gcovr</div></div><p>For best results make sure you have at least version 7.2.</p>
<p>The following command will generate a detailed report for each file: </p><div class="c-code__block c-code__block--outline"><div class="c-code__line">mkdir -p coverage; gcovr --html-detail -o coverage/coverage.html; open coverage/coverage.html</div></div><p>To check the summary run: </p><div class="c-code__block c-code__block--outline"><div class="c-code__line">gcovr -r . --print-summary</div></div> </section></div><!-- PageDoc -->
</div><!-- primary -->
</div><!-- inner-->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<section id="nav-path" class="g-footer g-footer--docs"><!-- id is needed for treeview function! -->
    <p class="g-footer__copyright">Generated by
    <a href="http://www.doxygen.org/index.html">
    <b>doxygen</b></a> 1.8.15
  </p>
</section>
</div>
</main>
</div>
</body>
</html>
